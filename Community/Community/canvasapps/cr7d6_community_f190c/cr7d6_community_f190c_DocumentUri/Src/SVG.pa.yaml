# ************************************************************************************************
# Warning: YAML source code for Canvas Apps should only be used to review changes made within Power Apps Studio and for minor edits (Preview).
# Use the maker portal to create and edit your Power Apps.
# 
# The schema file for Canvas Apps is available at https://go.microsoft.com/fwlink/?linkid=2304907
# 
# For more information, visit https://go.microsoft.com/fwlink/?linkid=2292623
# ************************************************************************************************
Screens:
  SVG:
    Properties:
      LoadingSpinnerColor: =RGBA(56, 96, 178, 1)
    Children:
      - ButtonCanvas2_1:
          Control: Button@0.0.45
          Properties:
            OnSelect: |
              =ClearCollect(col_dsvg1, ForAll(Sequence(7),{idx:ThisRecord.Value,datavalue: RandBetween(-100, 100)}));
              ClearCollect(col_dsvg2, ForAll(Sequence(7),{idx:ThisRecord.Value,datavalue:  RandBetween(-100, 100)}));
              ClearCollect(col_dsvg3, ForAll(Sequence(7),{idx:ThisRecord.Value,datavalue:  RandBetween(-100, 100)}));
            X: =38
            Y: =6
      - htmlSVG_1:
          Control: HtmlViewer@2.1.0
          Properties:
            Font: =Font.'Open Sans'
            Height: =708
            HtmlText: |-
              ="<div style='width:100%; height:" & (Self.Height - 20) & "px; display:flex; align-items:center; justify-content:flex-start;
                   background:linear-gradient(135deg,#4facfe,#00f2fe); border-radius:15px; padding:10px; box-sizing:border-box; overflow:hidden;'>
                <img alt='' style='width:auto; height:100%;' 
                     src='data:image/svg+xml;utf8," & EncodeUrl(
                  "<svg xmlns='http://www.w3.org/2000/svg' width='600' height='300'>" &
                /* Background gridlines */
               Concat(
                      Sequence(11) As G,
                      "<line x1='50' y1='" & (20 + (G.Value - 1) * 25) & "' x2='580' y2='" & (20 + (G.Value - 1) * 25) & "' stroke='#ddd' stroke-width='1'/>"
                  ) &
                /* Y-axis labels */
               Concat(
                      Sequence(11) As G,
                      "<text x='20' y='" & (25 + (G.Value - 1) * 25) & "' font-size='10' font-family='Segoe UI'>" & Text(100 - (G.Value - 1)*20) & "</text>"
                  ) &
                /* Zero axis line */
               "<line x1='50' y1='145' x2='580' y2='145' stroke='black' stroke-width='1'/>" &
                /* Bars Dataset 2 (red) */
               Concat(
                      Sequence(7) As I,
                      With(
                          {
                              v: LookUp(
                                  col_dsvg2,
                                  idx = I.Value,
                                  datavalue
                              ),
                              centerY: 145
                          },
                          "<rect x='" & (I.Value * 70) & "' y='" & If(
                              v >= 0,
                              centerY - v,
                              centerY
                          ) & "' width='20' height='" & Abs(v) & "' fill='crimson'/>"
                      )
                  ) &
                /* Bars Dataset 3 (teal) */
               Concat(
                      Sequence(7) As I,
                      With(
                          {
                              v: LookUp(
                                  col_dsvg3,
                                  idx = I.Value,
                                  datavalue
                              ),
                              centerY: 145
                          },
                          "<rect x='" & (I.Value * 70 + 25) & "' y='" & If(
                              v >= 0,
                              centerY - v,
                              centerY
                          ) & "' width='20' height='" & Abs(v) & "' fill='teal'/>"
                      )
                  ) &
                /* Line Dataset 1 */
               "<polyline fill='none' stroke='royalblue' stroke-width='2' points='" & Concat(
                      Sequence(7) As I,
                      (I.Value * 70 + 10) & "," & (145 - LookUp(
                          col_dsvg1,
                          idx = I.Value,
                          datavalue
                      )),
                      " "
                  ) & "'/>" &
                /* Circles for Line Dataset 1 */
               Concat(
                      Sequence(7) As I,
                      "<circle cx='" & (I.Value * 70 + 10) & "' cy='" & (145 - LookUp(
                          col_dsvg1,
                          idx = I.Value,
                          datavalue
                      )) & "' r='4' fill='white' stroke='royalblue' stroke-width='2'/>"
                  ) &
                /* X-axis labels */
               "<text x='100' y='280' font-size='12'>January</text>" & "<text x='170' y='280' font-size='12'>February</text>" & "<text x='240' y='280' font-size='12'>March</text>" & "<text x='310' y='280' font-size='12'>April</text>" & "<text x='380' y='280' font-size='12'>May</text>" & "<text x='450' y='280' font-size='12'>June</text>" & "<text x='520' y='280' font-size='12'>July</text>" &
                /* Legend */
               "<rect x='150' y='10' width='20' height='10' fill='royalblue'/>" & "<text x='175' y='20' font-size='12'>Dataset 1</text>" & "<rect x='250' y='10' width='20' height='10' fill='crimson'/>" & "<text x='275' y='20' font-size='12'>Dataset 2</text>" & "<rect x='350' y='10' width='20' height='10' fill='teal'/>" & "<text x='375' y='20' font-size='12'>Dataset 3</text>" & "</svg>"
              ) & "' />
              </div>"
            Width: =1363
            Y: =52
